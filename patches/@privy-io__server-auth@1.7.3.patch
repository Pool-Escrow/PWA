diff --git a/dist/index.mjs b/dist/index.mjs
index 185b3c61942fd3f15a459464eb3272558f9158e7..139df2002ce8a10185e858adfec7e6cea7844949 100644
--- a/dist/index.mjs
+++ b/dist/index.mjs
@@ -1 +1 @@
-var j="1.7.3";var P=process.env.PRIVY_API_URL||"https://auth.privy.io",O=1e4,I=j;import $ from"redaxios";var m=class extends Error{constructor(t,r){super(t);r instanceof Error&&(this.cause=r)}toString(){return`${this.type}: ${this.message}`}},T=class extends m{constructor(t,r,a,i){super(a,i);this.type=t;this.status=r}},y=class extends m{constructor(t,r){super(t,r);this.type="client_error"}};function F(s){return typeof s=="object"&&(s==null?void 0:s.url)?{type:"redaxios",error:s}:s instanceof Error?{type:"error",error:s}:{type:"internal",error:new y(`Internal error: ${s}`)}}var w=s=>{var r,a;let{type:e,error:t}=F(s);return e!=="redaxios"?n(t):new T(((r=t.data)==null?void 0:r.code)??"api_error",t.status,((a=t.data)==null?void 0:a.error)??t.statusText,t)},n=s=>s instanceof m?s:s instanceof Error?new y(s.message,s):new y(`Internal error: ${s}`);import{fetch as L}from"node-fetch-native";function D(s){if(typeof btoa<"u"&&typeof btoa=="function")return btoa(s);if(typeof Buffer=="function")return Buffer.from(s).toString("base64");throw new Error("@privy-io/server-auth is running in an unsupported environment")}function S(s){if(typeof L>"u")throw new Error("Fetch is missing from this environment, use browser or node env");return function(t,r){return L(t,{...r,signal:AbortSignal.timeout(s)})}}var b=class{constructor(e,t,{baseURL:r,timeout:a}){this.sdkVersion=I,this.instance=$.create({baseURL:r,fetch:S(a),auth:`Basic ${D(`${e}:${t}`)}`,headers:{"privy-app-id":e,"privy-client":`server-auth:${this.sdkVersion}`}})}async get(e,t){try{return await this.instance.get(e,t)}catch(r){throw w(r)}}async post(e,t,r){try{return await this.instance.post(e,t,r)}catch(a){throw w(a)}}async delete(e,t,r){try{return await this.instance.delete(e,{...r,data:t})}catch(a){throw w(a)}}};import q from"querystring";var U=s=>`/api/v1/users/${s}`,C=({cursor:s,limit:e=100}={})=>`/api/v1/users?${q.stringify({cursor:s?[s]:[],limit:e?[e]:[]})}`,f=()=>"/api/v1/users/search",G=()=>"/api/v1/users/farcaster/fid",x=s=>`/api/v1/apps/${s}`,_=s=>`${x(s)}/allowlist`;function o(s){return new Date(s*1e3)}function K(s){return s.map(e=>{switch(e.type){case"wallet":return{address:e.address,type:e.type,verifiedAt:o(e.verified_at),chainType:e.chain_type,chainId:e.chain_id,walletType:e.wallet_type,walletClientType:e.wallet_client_type,connectorType:e.connector_type};case"email":return{address:e.address,type:e.type,verifiedAt:o(e.verified_at)};case"phone":return{number:e.phoneNumber,type:e.type,verifiedAt:o(e.verified_at)};case"google_oauth":return{subject:e.subject,email:e.email,name:e.name,type:e.type,verifiedAt:o(e.verified_at)};case"twitter_oauth":return{subject:e.subject,username:e.username,name:e.name,profilePictureUrl:e.profile_picture_url,type:e.type,verifiedAt:o(e.verified_at)};case"discord_oauth":return{subject:e.subject,username:e.username,email:e.email,type:e.type,verifiedAt:o(e.verified_at)};case"github_oauth":return{subject:e.subject,username:e.username,email:e.email,name:e.name,type:e.type,verifiedAt:o(e.verified_at)};case"apple_oauth":return{subject:e.subject,email:e.email,type:e.type,verifiedAt:o(e.verified_at)};case"linkedin_oauth":return{subject:e.subject,email:e.email,name:e.name,type:e.type,verifiedAt:o(e.verified_at)};case"tiktok_oauth":return{subject:e.subject,username:e.username,name:e.name,type:e.type,verifiedAt:o(e.verified_at)};case"custom_auth":return{customUserId:e.custom_user_id,type:e.type,verifiedAt:o(e.verified_at)};case"farcaster":return{type:e.type,fid:e.fid,ownerAddress:e.owner_address,displayName:e.display_name,username:e.username,bio:e.bio,pfp:e.profile_picture,url:e.homepage_url,verifiedAt:o(e.verified_at)};default:return null}}).filter(e=>e!==null)}function p(s,e){return s.sort((t,r)=>r.verifiedAt.getTime()-t.verifiedAt.getTime()),s.find(t=>t.type===e)}function d(s){if(!s)return null;let e=K(s.linked_accounts),t=p(e,"wallet"),r=p(e,"email"),a=p(e,"phone"),i=p(e,"google_oauth"),u=p(e,"twitter_oauth"),l=p(e,"discord_oauth"),c=p(e,"github_oauth"),k=p(e,"apple_oauth"),g=p(e,"linkedin_oauth"),A=p(e,"tiktok_oauth"),E=p(e,"custom_auth"),h=p(e,"farcaster");return{id:s.id,createdAt:o(s.created_at),linkedAccounts:e,email:r&&{address:r==null?void 0:r.address},phone:a&&{number:a==null?void 0:a.number},wallet:t&&{address:t.address,chainType:t.chainType,chainId:t.chainId,walletType:t.walletType,walletClientType:t.walletClientType,connectorType:t.connectorType},google:i&&{subject:i.subject,email:i.email,name:i.name},twitter:u&&{subject:u.subject,username:u.username,name:u.name,profilePictureUrl:u.profilePictureUrl},discord:l&&{subject:l.subject,username:l.username,email:l.email},github:c&&{subject:c.subject,username:c.username,email:c.email,name:c.name},apple:k&&{subject:k.subject,email:k.email},linkedIn:g&&{subject:g.subject,email:g.email,name:g.name},tiktok:A&&{subject:A.subject,username:A.username,name:A.name},custom:E&&{customUserId:E.customUserId},farcaster:h&&{fid:h.fid,ownerAddress:h.ownerAddress,displayName:h.displayName,username:h.username,bio:h.bio,pfp:h.pfp,url:h.url}}}import*as v from"jose";import{objectToCamel as R,objectToSnake as W}from"ts-case-convert";var M=class{constructor(e,t,r={}){this.verificationKey=null;let a=r.apiURL||P,i=r.timeout||O;this.appId=e,this.api=new b(e,t,{baseURL:a,timeout:i})}async getUser(e){try{let t=U(e),r=await this.api.get(t);return d(r.data)}catch(t){throw n(t)}}async getUserByEmail(e){try{let t=f(),r=await this.api.post(t,{emails:[e]});return r.data.data.length?d(r.data.data[0]):null}catch(t){throw n(t)}}async getUserByPhoneNumber(e){try{let t=f(),r=await this.api.post(t,{phoneNumbers:[e]});return r.data.data.length?d(r.data.data[0]):null}catch(t){throw n(t)}}async getUserByWalletAddress(e){try{let t=f(),r=await this.api.post(t,{walletAddresses:[e]});return r.data.data.length?d(r.data.data[0]):null}catch(t){throw n(t)}}async getUserByFarcasterId(e){try{let t=G(),r=await this.api.post(t,{fid:e});return d(r.data)}catch(t){throw n(t)}}async getUsers(e){try{let t=[],r=typeof e=="string"?{searchTerm:e}:{...e},a=f(),i=await this.api.post(a,r);for(t.push(...i.data.data.map(u=>d(u)));i.data.next_cursor!==null;)i=await this.api.post(a,{...r,cursor:i.data.next_cursor}),t.push(...i.data.data.map(u=>d(u)));return t}catch(t){throw n(t)}}async deleteUser(e){try{let t=U(e);await this.api.delete(t)}catch(t){throw n(t)}}async importUser({createEmbeddedWallet:e,linkedAccounts:t}){let r=W(t);try{let a=C(),i=await this.api.post(a,{create_embedded_wallet:e||!1,linked_accounts:r});return d(i.data)}catch(a){throw n(a)}}async getAppSettings(){try{let e=x(this.appId),t=await this.api.get(e);return{id:t.data.id,name:t.data.name,verificationKey:t.data.verification_key,logoUrl:t.data.logo_url||void 0,theme:t.data.theme,accentColor:t.data.accent_color||void 0,walletAuth:t.data.wallet_auth,emailAuth:t.data.email_auth,smsAuth:t.data.sms_auth,googleOAuth:t.data.google_oauth,twitterOAuth:t.data.twitter_oauth,discordOAuth:t.data.discord_oauth,githubOAuth:t.data.github_oauth,appleOAuth:t.data.apple_oauth,linkedInOAuth:t.data.linkedin_oauth,tiktokOAuth:t.data.tiktok_oauth,termsAndConditionsUrl:t.data.terms_and_conditions_url,privacyPolicyUrl:t.data.privacy_policy_url,allowlistEnabled:t.data.allowlist_enabled,allowlistConfig:{errorTitle:t.data.allowlist_config.error_title,errorDetail:t.data.allowlist_config.error_detail,ctaText:t.data.allowlist_config.cta_text,ctaLink:t.data.allowlist_config.cta_link},createdAt:new Date(t.data.created_at*1e3),updatedAt:new Date(t.data.updated_at*1e3)}}catch(e){throw n(e)}}async getAllowlist(){try{let e=_(this.appId);return(await this.api.get(e)).data.map(r=>R(r))}catch(e){throw n(e)}}async inviteToAllowlist(e){let t=W(e);try{let r=_(this.appId),a=await this.api.post(r,t);return R(a.data)}catch(r){throw n(r)}}async removeFromAllowlist(e){let t=W(e);try{let r=_(this.appId),a=await this.api.delete(r,t);return R(a.data)}catch(r){throw n(r)}}async verifyAuthToken(e,t=""){let r="privy.io",a="ES256",i=t||await this.getVerificationKey(),u=await v.importSPKI(i,a),l=await v.jwtVerify(e,u,{typ:"JWT",algorithms:[a],issuer:r,audience:this.appId});return{appId:l.payload.aud,issuer:l.payload.iss,issuedAt:l.payload.iat,expiration:l.payload.exp,sessionId:l.payload.sid,userId:l.payload.sub}}async getVerificationKey(){if(this.verificationKey)return this.verificationKey;let e=await this.getAppSettings();return this.verificationKey=e.verificationKey,this.verificationKey}};if(typeof window<"u")throw new Error("@privy-io/server-auth cannot be used in a browser environment");export{M as PrivyClient};
+var j="1.7.3";var P=process.env.PRIVY_API_URL||"https://auth.privy.io",O=1e4,I=j;import $ from"redaxios";var m=class extends Error{constructor(t,r){super(t);r instanceof Error&&(this.cause=r)}toString(){return`${this.type}: ${this.message}`}},T=class extends m{constructor(t,r,a,i){super(a,i);this.type=t;this.status=r}},y=class extends m{constructor(t,r){super(t,r);this.type="client_error"}};function F(s){return typeof s=="object"&&(s==null?void 0:s.url)?{type:"redaxios",error:s}:s instanceof Error?{type:"error",error:s}:{type:"internal",error:new y(`Internal error: ${s}`)}}var w=s=>{var r,a;let{type:e,error:t}=F(s);return e!=="redaxios"?n(t):new T(((r=t.data)==null?void 0:r.code)??"api_error",t.status,((a=t.data)==null?void 0:a.error)??t.statusText,t)},n=s=>s instanceof m?s:s instanceof Error?new y(s.message,s):new y(`Internal error: ${s}`);import{fetch as L}from"node-fetch-native";function D(s){if(typeof btoa<"u"&&typeof btoa=="function")return btoa(s);if(typeof Buffer=="function")return Buffer.from(s).toString("base64");throw new Error("@privy-io/server-auth is running in an unsupported environment")}function S(s){if(typeof L>"u")throw new Error("Fetch is missing from this environment, use browser or node env");return function(t,r){return L(t,{...r,signal:AbortSignal.timeout(s)})}}var b=class{constructor(e,t,{baseURL:r,timeout:a}){this.sdkVersion=I,this.instance=$.create({baseURL:r,fetch:S(a),auth:`Basic ${D(`${e}:${t}`)}`,headers:{"privy-app-id":e,"privy-client":`server-auth:${this.sdkVersion}`}})}async get(e,t){try{return await this.instance.get(e,t)}catch(r){throw w(r)}}async post(e,t,r){try{return await this.instance.post(e,t,r)}catch(a){throw w(a)}}async delete(e,t,r){try{return await this.instance.delete(e,{...r,data:t})}catch(a){throw w(a)}}};import * as q from"native-querystring";var U=s=>`/api/v1/users/${s}`,C=({cursor:s,limit:e=100}={})=>`/api/v1/users?${q.stringify({cursor:s?[s]:[],limit:e?[e]:[]})}`,f=()=>"/api/v1/users/search",G=()=>"/api/v1/users/farcaster/fid",x=s=>`/api/v1/apps/${s}`,_=s=>`${x(s)}/allowlist`;function o(s){return new Date(s*1e3)}function K(s){return s.map(e=>{switch(e.type){case"wallet":return{address:e.address,type:e.type,verifiedAt:o(e.verified_at),chainType:e.chain_type,chainId:e.chain_id,walletType:e.wallet_type,walletClientType:e.wallet_client_type,connectorType:e.connector_type};case"email":return{address:e.address,type:e.type,verifiedAt:o(e.verified_at)};case"phone":return{number:e.phoneNumber,type:e.type,verifiedAt:o(e.verified_at)};case"google_oauth":return{subject:e.subject,email:e.email,name:e.name,type:e.type,verifiedAt:o(e.verified_at)};case"twitter_oauth":return{subject:e.subject,username:e.username,name:e.name,profilePictureUrl:e.profile_picture_url,type:e.type,verifiedAt:o(e.verified_at)};case"discord_oauth":return{subject:e.subject,username:e.username,email:e.email,type:e.type,verifiedAt:o(e.verified_at)};case"github_oauth":return{subject:e.subject,username:e.username,email:e.email,name:e.name,type:e.type,verifiedAt:o(e.verified_at)};case"apple_oauth":return{subject:e.subject,email:e.email,type:e.type,verifiedAt:o(e.verified_at)};case"linkedin_oauth":return{subject:e.subject,email:e.email,name:e.name,type:e.type,verifiedAt:o(e.verified_at)};case"tiktok_oauth":return{subject:e.subject,username:e.username,name:e.name,type:e.type,verifiedAt:o(e.verified_at)};case"custom_auth":return{customUserId:e.custom_user_id,type:e.type,verifiedAt:o(e.verified_at)};case"farcaster":return{type:e.type,fid:e.fid,ownerAddress:e.owner_address,displayName:e.display_name,username:e.username,bio:e.bio,pfp:e.profile_picture,url:e.homepage_url,verifiedAt:o(e.verified_at)};default:return null}}).filter(e=>e!==null)}function p(s,e){return s.sort((t,r)=>r.verifiedAt.getTime()-t.verifiedAt.getTime()),s.find(t=>t.type===e)}function d(s){if(!s)return null;let e=K(s.linked_accounts),t=p(e,"wallet"),r=p(e,"email"),a=p(e,"phone"),i=p(e,"google_oauth"),u=p(e,"twitter_oauth"),l=p(e,"discord_oauth"),c=p(e,"github_oauth"),k=p(e,"apple_oauth"),g=p(e,"linkedin_oauth"),A=p(e,"tiktok_oauth"),E=p(e,"custom_auth"),h=p(e,"farcaster");return{id:s.id,createdAt:o(s.created_at),linkedAccounts:e,email:r&&{address:r==null?void 0:r.address},phone:a&&{number:a==null?void 0:a.number},wallet:t&&{address:t.address,chainType:t.chainType,chainId:t.chainId,walletType:t.walletType,walletClientType:t.walletClientType,connectorType:t.connectorType},google:i&&{subject:i.subject,email:i.email,name:i.name},twitter:u&&{subject:u.subject,username:u.username,name:u.name,profilePictureUrl:u.profilePictureUrl},discord:l&&{subject:l.subject,username:l.username,email:l.email},github:c&&{subject:c.subject,username:c.username,email:c.email,name:c.name},apple:k&&{subject:k.subject,email:k.email},linkedIn:g&&{subject:g.subject,email:g.email,name:g.name},tiktok:A&&{subject:A.subject,username:A.username,name:A.name},custom:E&&{customUserId:E.customUserId},farcaster:h&&{fid:h.fid,ownerAddress:h.ownerAddress,displayName:h.displayName,username:h.username,bio:h.bio,pfp:h.pfp,url:h.url}}}import*as v from"jose";import{objectToCamel as R,objectToSnake as W}from"ts-case-convert";var M=class{constructor(e,t,r={}){this.verificationKey=null;let a=r.apiURL||P,i=r.timeout||O;this.appId=e,this.api=new b(e,t,{baseURL:a,timeout:i})}async getUser(e){try{let t=U(e),r=await this.api.get(t);return d(r.data)}catch(t){throw n(t)}}async getUserByEmail(e){try{let t=f(),r=await this.api.post(t,{emails:[e]});return r.data.data.length?d(r.data.data[0]):null}catch(t){throw n(t)}}async getUserByPhoneNumber(e){try{let t=f(),r=await this.api.post(t,{phoneNumbers:[e]});return r.data.data.length?d(r.data.data[0]):null}catch(t){throw n(t)}}async getUserByWalletAddress(e){try{let t=f(),r=await this.api.post(t,{walletAddresses:[e]});return r.data.data.length?d(r.data.data[0]):null}catch(t){throw n(t)}}async getUserByFarcasterId(e){try{let t=G(),r=await this.api.post(t,{fid:e});return d(r.data)}catch(t){throw n(t)}}async getUsers(e){try{let t=[],r=typeof e=="string"?{searchTerm:e}:{...e},a=f(),i=await this.api.post(a,r);for(t.push(...i.data.data.map(u=>d(u)));i.data.next_cursor!==null;)i=await this.api.post(a,{...r,cursor:i.data.next_cursor}),t.push(...i.data.data.map(u=>d(u)));return t}catch(t){throw n(t)}}async deleteUser(e){try{let t=U(e);await this.api.delete(t)}catch(t){throw n(t)}}async importUser({createEmbeddedWallet:e,linkedAccounts:t}){let r=W(t);try{let a=C(),i=await this.api.post(a,{create_embedded_wallet:e||!1,linked_accounts:r});return d(i.data)}catch(a){throw n(a)}}async getAppSettings(){try{let e=x(this.appId),t=await this.api.get(e);return{id:t.data.id,name:t.data.name,verificationKey:t.data.verification_key,logoUrl:t.data.logo_url||void 0,theme:t.data.theme,accentColor:t.data.accent_color||void 0,walletAuth:t.data.wallet_auth,emailAuth:t.data.email_auth,smsAuth:t.data.sms_auth,googleOAuth:t.data.google_oauth,twitterOAuth:t.data.twitter_oauth,discordOAuth:t.data.discord_oauth,githubOAuth:t.data.github_oauth,appleOAuth:t.data.apple_oauth,linkedInOAuth:t.data.linkedin_oauth,tiktokOAuth:t.data.tiktok_oauth,termsAndConditionsUrl:t.data.terms_and_conditions_url,privacyPolicyUrl:t.data.privacy_policy_url,allowlistEnabled:t.data.allowlist_enabled,allowlistConfig:{errorTitle:t.data.allowlist_config.error_title,errorDetail:t.data.allowlist_config.error_detail,ctaText:t.data.allowlist_config.cta_text,ctaLink:t.data.allowlist_config.cta_link},createdAt:new Date(t.data.created_at*1e3),updatedAt:new Date(t.data.updated_at*1e3)}}catch(e){throw n(e)}}async getAllowlist(){try{let e=_(this.appId);return(await this.api.get(e)).data.map(r=>R(r))}catch(e){throw n(e)}}async inviteToAllowlist(e){let t=W(e);try{let r=_(this.appId),a=await this.api.post(r,t);return R(a.data)}catch(r){throw n(r)}}async removeFromAllowlist(e){let t=W(e);try{let r=_(this.appId),a=await this.api.delete(r,t);return R(a.data)}catch(r){throw n(r)}}async verifyAuthToken(e,t=""){let r="privy.io",a="ES256",i=t||await this.getVerificationKey(),u=await v.importSPKI(i,a),l=await v.jwtVerify(e,u,{typ:"JWT",algorithms:[a],issuer:r,audience:this.appId});return{appId:l.payload.aud,issuer:l.payload.iss,issuedAt:l.payload.iat,expiration:l.payload.exp,sessionId:l.payload.sid,userId:l.payload.sub}}async getVerificationKey(){if(this.verificationKey)return this.verificationKey;let e=await this.getAppSettings();return this.verificationKey=e.verificationKey,this.verificationKey}};if(typeof window<"u")throw new Error("@privy-io/server-auth cannot be used in a browser environment");export{M as PrivyClient};
diff --git a/package.json b/package.json
index 3a5dab1a2e94cfad81acc4bfd20465cd33bcd3f8..9e3f5a8065c3b9d20358b01967038cdcb9880d4c 100644
--- a/package.json
+++ b/package.json
@@ -46,6 +46,7 @@
   "dependencies": {
     "dotenv": "^16.0.3",
     "jose": "^4.10.4",
+    "native-querystring": "1.1.1",
     "node-fetch-native": "^1.4.0",
     "redaxios": "^0.5.1",
     "ts-case-convert": "^2.0.2",
